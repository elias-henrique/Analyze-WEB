#!/usr/bin/env python3
"""
Admin Exploit - Exploração de acesso administrativo

Script de exploração para tentar acessar painéis admin.
"""

import argparse
import sys

from exploits.exploit_admin import AdminAccessExploit
from lib.utils import configure_logging


def parse_args(argv=None):
    """Parse argumentos da linha de comando."""
    parser = argparse.ArgumentParser(
        description="Exploração de acesso administrativo."
    )
    parser.add_argument(
        "target",
        help="URL base do alvo",
    )
    parser.add_argument(
        "-v",
        "--verbose",
        action="store_true",
        help="Ativa modo verboso (debug).",
    )
    return parser.parse_args(argv)


def main(argv=None):
    """Função principal."""
    args = parse_args(argv)
    configure_logging(args.verbose)

    target = args.target
    if not target.startswith(("http://", "https://")):
        target = "https://" + target

    exploiter = AdminAccessExploit(target)
    exploiter.run_complete_exploit()

    return 0


if __name__ == "__main__":
    sys.exit(main())
